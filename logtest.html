<script>
//var Web3 = require('web3');
var abi = [ { "constant": false, "inputs": [ { "name": "x", "type": "uint256" } ], "name": "set", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [], "name": "get", "outputs": [ { "name": "", "type": "uint256", "value": "0" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "_from", "type": "address" }, { "indexed": false, "name": "_x", "type": "uint256" } ], "name": "SetEvent", "type": "event" } ];
var address = '0xC802FB7ff21e148C71ba9ca28535bb08d1FA14D2'

//var web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
var basicStorageContract = web3.eth.contract(abi);
var basicStorageContractInstance = basicStorageContract.at(address);

// watch for changes
var myEvent = basicStorageContractInstance.SetEvent({}, {fromBlock: 1350474, toBlock: 'latest'});

console.log("Start watching events");
myEvent.watch(function(error, result){
    if (!error) {
        console.log(result);
    } else {
        console.log(error);
    }
});



// Send a transaction to call Set
console.log("set(111)");
basicStorageContractInstance.set(111, {from: '0x2Ff10986b8877248112815f1d46F358B32161883'},
  function(error,result){
    console.log('caught',result);
    myEvent.stopWatching();
  });

//console.log("set(20)");
//basicStorageContractInstance.set(20, {from: '0x2Ff10986b8877248112815f1d46F358B32161883'});

</script>
